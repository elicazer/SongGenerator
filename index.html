<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Generator v3</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0f1923 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            text-align: center;
            font-size: 2.8em;
            margin-bottom: 5px;
            background: linear-gradient(90deg, #00d9ff, #ff00aa, #00d9ff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient 3s linear infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 0.9em; }
        .panel {
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .panel h2 { 
            font-size: 1em; 
            margin-bottom: 20px; 
            color: #00d9ff;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }
        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.85em;
            color: #888;
        }
        select, input[type="range"] {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.08);
            color: #fff;
            font-size: 0.95em;
        }
        select { cursor: pointer; }
        select option { background: #1a1a2e; }
        input[type="range"] { 
            -webkit-appearance: none; 
            height: 6px; 
            padding: 0;
            border-radius: 3px;
            cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px; height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d9ff, #ff00aa);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0,217,255,0.5);
        }
        .btn-row {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 25px;
        }
        button {
            padding: 14px 35px;
            font-size: 1em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-generate { 
            background: linear-gradient(135deg, #00d9ff, #0099cc); 
            color: #000;
        }
        .btn-generate:hover { 
            transform: scale(1.05); 
            box-shadow: 0 5px 30px rgba(0,217,255,0.4); 
        }
        .btn-play { 
            background: linear-gradient(135deg, #00ff88, #00cc6a); 
            color: #000;
        }
        .btn-play:hover { transform: scale(1.05); box-shadow: 0 5px 30px rgba(0,255,136,0.4); }
        .btn-stop {
            background: transparent;
            color: #fff;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .btn-stop:hover { background: rgba(255,255,255,0.1); }
        .btn-export { 
            background: linear-gradient(135deg, #ff00aa, #cc0088); 
            color: #fff;
        }
        .btn-export:hover { transform: scale(1.05); box-shadow: 0 5px 30px rgba(255,0,170,0.4); }
        button:disabled { opacity: 0.4; cursor: not-allowed; transform: none !important; box-shadow: none !important; }
        .visualizer {
            height: 180px;
            background: rgba(0,0,0,0.4);
            border-radius: 15px;
            margin-top: 20px;
            overflow: hidden;
            position: relative;
        }
        #waveform { width: 100%; height: 100%; }
        .progress-bar {
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            margin-top: 15px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d9ff, #ff00aa);
            width: 0%;
            transition: width 0.1s linear;
        }
        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #666;
            margin-top: 8px;
            font-family: monospace;
        }
        .song-info {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(0,217,255,0.1), rgba(255,0,170,0.1));
            border-radius: 15px;
            display: none;
        }
        .song-info.visible { display: block; }
        .song-info h3 { 
            color: #fff; 
            margin-bottom: 8px;
            font-size: 1.4em;
        }
        .song-info p { color: #888; font-size: 0.85em; }
        .loading {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            flex-direction: column;
            gap: 20px;
        }
        .loading.hidden { display: none; }
        .spinner {
            width: 60px; height: 60px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: #00d9ff;
            border-right-color: #ff00aa;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        .loading p { color: #888; font-size: 0.9em; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .section-preview {
            display: flex;
            gap: 4px;
            margin-top: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .section-block {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.7em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .section-block.intro { background: rgba(100,100,255,0.3); }
        .section-block.verse { background: rgba(0,217,255,0.3); }
        .section-block.prechorus { background: rgba(255,170,0,0.3); }
        .section-block.chorus { background: rgba(255,0,170,0.3); }
        .section-block.bridge { background: rgba(0,255,136,0.3); }
        .section-block.drop { background: rgba(255,0,0,0.3); }
        .section-block.outro { background: rgba(100,100,255,0.3); }
        .section-block.active { box-shadow: 0 0 15px currentColor; transform: scale(1.1); }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p id="loadingText">Initializing...</p>
    </div>

    <div class="container">
        <h1>Song Generator v3</h1>
        <p class="subtitle">Advanced procedural music with dynamic arrangements</p>
        
        <div class="panel">
            <h2>üéõÔ∏è Configuration</h2>
            <div class="controls">
                <div class="control-group">
                    <label>Genre</label>
                    <select id="genre">
                        <option value="lofi">Lo-Fi Chill</option>
                        <option value="edm">EDM / House</option>
                        <option value="synthwave">Synthwave</option>
                        <option value="dnb">Drum & Bass</option>
                        <option value="chiptune">Chiptune</option>
                        <option value="ambient">Ambient</option>
                        <option value="jazz">Jazz / Neo-Soul</option>
                        <option value="rock">Indie Rock</option>
                        <option value="hiphop">Hip-Hop</option>
                        <option value="trap">Trap</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>Key</label>
                    <select id="key">
                        <option value="C">C Major</option>
                        <option value="G">G Major</option>
                        <option value="D">D Major</option>
                        <option value="A">A Major</option>
                        <option value="F">F Major</option>
                        <option value="Am">A Minor</option>
                        <option value="Em">E Minor</option>
                        <option value="Dm">D Minor</option>
                        <option value="Fm">F Minor</option>
                        <option value="Cm">C Minor</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>Tempo: <span id="tempoVal">120</span> BPM</label>
                    <input type="range" id="tempo" min="70" max="180" value="120">
                </div>
                <div class="control-group">
                    <label>Energy: <span id="energyVal">70</span>%</label>
                    <input type="range" id="energy" min="20" max="100" value="70">
                </div>
                <div class="control-group">
                    <label>Complexity: <span id="complexityVal">60</span>%</label>
                    <input type="range" id="complexity" min="20" max="100" value="60">
                </div>
                <div class="control-group">
                    <label>Duration: <span id="durationVal">2:00</span></label>
                    <input type="range" id="duration" min="60" max="240" value="120" step="30">
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>üéπ Playback</h2>
            <div class="btn-row">
                <button class="btn-generate" id="generateBtn">Generate</button>
                <button class="btn-play" id="playBtn" disabled>‚ñ∂ Play</button>
                <button class="btn-stop" id="stopBtn" disabled>‚èπ Stop</button>
                <button class="btn-export" id="exportBtn" disabled>Export WAV</button>
            </div>
            
            <div class="visualizer">
                <canvas id="waveform"></canvas>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
            <div class="time-display">
                <span id="currentTime">0:00</span>
                <span id="totalTime">2:00</span>
            </div>
            
            <div class="section-preview" id="sectionPreview"></div>
            
            <div class="song-info" id="songInfo">
                <h3 id="songTitle">Untitled Track</h3>
                <p id="songDetails">Generating...</p>
            </div>
        </div>
    </div>

    <script src="song-engine-v3.js"></script>
</body>
</html>
